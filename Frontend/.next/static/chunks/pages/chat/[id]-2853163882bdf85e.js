(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[934],{495:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[id]",function(){return t(5109)}])},5109:function(e,s,t){"use strict";t.r(s);var a=t(5893);t(3950),t(1497),t(5200);var l=t(1163),r=t(7294),i=t(3262),c=t(9779),n=t(8684),o=t(945),d=t(2469),u=t(2264);s.default=(0,c.Z)(()=>{let e=(0,l.useRouter)(),{id:s}=e.query,t=(0,r.useRef)(null),[c,m]=(0,r.useState)(!0),[h,f]=(0,r.useState)(""),[x,p]=(0,r.useState)(!1),[g,w]=(0,r.useState)([]),[j,v]=(0,r.useState)(!1),[b,N]=(0,r.useState)(null),[_,E]=(0,r.useState)([]),[y,L]=(0,r.useState)(!1),[k,S]=(0,r.useState)(!1),C=(0,r.useRef)(null),P=(0,r.useRef)(null),T=()=>{v(e=>!e)},I=e=>{C.current&&!C.current.contains(e.target)&&P.current&&!P.current.contains(e.target)&&m(!1)},R=e=>{switch(e){case"gris":return"bg-message-gris";case"celeste":return"bg-message-celeste";case"amarillo":return"bg-message-amarillo";case"rojo":return"bg-message-rojo";case"verde":return"bg-message-verde"}};return(0,r.useEffect)(()=>{(async()=>{f("http://localhost:8093/Uploads/"+(await (0,o.M2)(localStorage.getItem("token"))).profile_photo)})()},[]),(0,r.useEffect)(()=>{let e=async()=>{let e=await (0,d.mw)(s,localStorage.getItem("token"));console.log(e),e.success&&w(e.data)};s&&e()},[s]),(0,r.useEffect)(()=>{L(!0);let e=async()=>{let e=await (0,d.lY)(b,localStorage.getItem("token"));e.success&&(E(e.data.split("\n")),L(!1))};b&&e()},[b]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{var e;null===(e=t.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);return()=>clearTimeout(e)},[g]),(0,r.useEffect)(()=>{let e=()=>{window.innerWidth<=1024?(m(!1),S(!0)):(m(!0),S(!1))};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,r.useEffect)(()=>(window.innerWidth<=1024&&document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}),[c]),(0,a.jsx)("div",{className:"home-bg",children:(0,a.jsxs)("div",{className:"relative bg-white w-full h-full top-0 left-0",children:[(0,a.jsx)("div",{ref:P,className:"fixed z-20 top-2/4 left-[300px] cursor-pointer transform ".concat(c?"translate-x-0":"translate-x-[-300px]"," transition-transform duration-500 ease-in-out"),onClick:()=>m(!c),children:(0,a.jsx)("img",{src:"/assets/icons/arrow.png",className:"w-[25px] h-[25px] transition-transform duration-500 ease-in-out ".concat(c?"transform rotate-0":"transform rotate-180"),alt:"arrow"})}),(0,a.jsx)("div",{ref:C,children:(0,a.jsx)(i.Z,{isOpen:c,chat_id:s})}),j&&(0,a.jsx)("div",{className:"w-full h-full edit-info-bg fixed z-30 flex justify-center items-center",children:(0,a.jsxs)("div",{className:"recipe-popup",children:[(0,a.jsxs)("div",{className:"recipe-top",children:[(0,a.jsx)("label",{className:"recipe-title font-semibold",children:"Receta del plato"}),(0,a.jsx)("button",{onClick:T,children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 51 47",fill:"none",children:(0,a.jsx)("path",{d:"M13.125 34.7915L10.625 32.2915L20.625 22.2915L10.625 12.2915L13.125 9.7915L23.125 19.7915L33.125 9.7915L35.625 12.2915L25.625 22.2915L35.625 32.2915L33.125 34.7915L23.125 24.7915L13.125 34.7915Z",fill:"white"})})})]}),(0,a.jsx)("div",{className:"recipe-content text-white",children:y?(0,a.jsx)("div",{className:"animate-spin loading-recipe"}):(0,a.jsx)("div",{className:"flex flex-col items-start",children:_.map((e,s)=>(0,a.jsx)("p",{children:e},"line"+s))})})]})}),(0,a.jsxs)("div",{className:"top-bar fixed z-10 ".concat(k?"w-[100%]":c?"translate-x-[300px] top-bar-collapsed":"w-[100%]"," duration-500 ease-in-out"),children:[(0,a.jsx)("div",{className:"flex justify-center items-center w-9/12",children:(0,a.jsx)("label",{className:"title-profile",children:"DIETBOT v1.0"})}),(0,a.jsxs)("div",{className:"relative mt-[20px] mb-[20px] flex flex-col items-center justify-center",onClick:()=>{p(!x)},children:[(0,a.jsx)("div",{className:"".concat(x?"img-wrapper":"img-wrapper-scaled"),children:h?(0,a.jsx)("img",{className:"pfp-icon rounded-[100%]",src:h,alt:"Profile pic"}):(0,a.jsx)("img",{className:"pfp-icon",src:"/assets/icons/pfp.png",alt:"Profile pic"})}),x&&(0,a.jsxs)("div",{className:"absolute top-tab bg-white shadow-lg outline-none rounded-lg rounded-tr-none py-1",children:[(0,a.jsx)("button",{className:"block text-right pr-3 py-2 chat-text text-gray-700 hover:bg-gray-100 w-full",onClick:()=>{e.push("/perfil")},children:"Perfil"}),(0,a.jsx)("button",{className:"block text-right pr-3 py-2 chat-text text-gray-700 hover:bg-gray-100 w-full",onClick:()=>{confirm("\xbfDeseas cerrar sesi\xf3n?")&&((0,n.kS)(),e.push("/"))},children:"Cerrar sesi\xf3n"})]})]})]}),(0,a.jsxs)("div",{className:"chat-tab ".concat(k?"w-[100%]":c?"translate-x-[300px] top-bar-collapsed":"w-[100%]"," duration-500 ease-in-out"),children:[(0,a.jsx)("div",{className:"w-full h-[100px]"}),(0,a.jsxs)("div",{className:"chat-area extra-data",children:[g.map((e,s)=>e.is_bot?(0,a.jsxs)("div",{className:"w-full flex flex-row justify-start h-auto pt-[10px]",children:[(0,a.jsx)("img",{className:"bot-pic",src:"/assets/images/bot.png",alt:"Profile pic"}),(0,a.jsxs)("div",{className:"chat-container",children:[(0,a.jsx)("label",{className:"chat-name font-bold",children:"DIETBOT"}),"verde"===e.color?(0,a.jsx)("div",{className:"chat-bubble-3 chat-text ".concat(R(e.color)),children:(0,a.jsx)(u.Z,{name:e.msg,listResult:e.list_result,toggleRecipe:T,setDishId:N,porcion:e.f_Porcion,calorias:e.f_Calorias,carbohidratos:e.f_Carbohidratos,grasas:e.f_Grasas,proteinas:e.f_Proteinas})}):(0,a.jsx)("div",{className:"chat-bubble chat-text ".concat(R(e.color)),children:e.msg})]})]},s):(0,a.jsxs)("div",{className:"w-full flex flex-row justify-end h-auto pt-[10px]",children:[(0,a.jsxs)("div",{className:"chat-container-2",children:[(0,a.jsx)("label",{className:"chat-name font-bold",children:"T\xfa"}),(0,a.jsx)("div",{className:"chat-bubble-2 chat-text ".concat(R(e.color)),children:e.msg})]}),h?(0,a.jsx)("img",{className:"user-pic rounded-[100%]",src:h,alt:"Profile pic"}):(0,a.jsx)("img",{className:"user-pic",src:"/assets/icons/pfp.png",alt:"Profile pic"})]},s)),(0,a.jsx)("div",{ref:t})]})]})]})})})}},function(e){e.O(0,[729,525,653,398,58,888,774,179],function(){return e(e.s=495)}),_N_E=e.O()}]);